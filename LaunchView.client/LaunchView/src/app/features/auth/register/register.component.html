<div class="register-form">
    <h2 class="title">Create your account</h2>
    <p class="subtitle">It only takes a minute.</p>
    <!-- <mat-divider class="mb-3"></mat-divider> -->
  
    <form #f="ngForm" (ngSubmit)="submit(f)" class="form-grid" novalidate>
      <!-- First name -->
      <mat-form-field appearance="outline">
        <mat-label>First name</mat-label>
        <input
          matInput
          name="FirstName"
          [(ngModel)]="model.FirstName"
          #firstName="ngModel"
          required
          maxlength="20"
          autocomplete="given-name" />
          @if (firstName.invalid && firstName.touched){
            <mat-error >
                {{ firstName.errors?.['required'] ? 'First name is required' : 'Too long' }}
            </mat-error>
          }
      </mat-form-field>
  
      <!-- Last name -->
      <mat-form-field appearance="outline">
        <mat-label>Last name</mat-label>
        <input
          matInput
          name="LastName"
          [(ngModel)]="model.LastName"
          #lastName="ngModel"
          required
          maxlength="30"
          autocomplete="family-name" />
          @if (lastName.invalid && lastName.touched){
            <mat-error>
                {{ lastName.errors?.['required'] ? 'Last name is required' : 'Too long' }}
              </mat-error>
          }
      </mat-form-field>
  
      <!-- Email -->
      <mat-form-field appearance="outline" class="full">
        <mat-label>Email</mat-label>
        <input
          matInput
          type="email"
          name="Email"
          [(ngModel)]="model.Email"
          #email="ngModel"
          required
          email
          autocomplete="email" />
          @if (email.invalid && email.touched){
            <mat-error >
                {{ email.errors?.['required'] ? 'Email is required' : 'Enter a valid email' }}
            </mat-error>
          }
      </mat-form-field>
  
      <!-- Password -->
      <mat-form-field appearance="outline" class="full">
        <mat-label>Password</mat-label>
        <input
          matInput
          [type]="showPwd ? 'text' : 'password'"
          name="Password"
          [(ngModel)]="model.Password"
          #password="ngModel"
          required
          minlength="8"
          pattern="^(?=.*[A-Za-z])(?=.*\d).+$"
          autocomplete="new-password" />
        <button mat-icon-button matSuffix type="button"
                (click)="showPwd = !showPwd"
                [attr.aria-label]="showPwd ? 'Hide password' : 'Show password'">
          <mat-icon>{{ showPwd ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        @if (password.invalid && password.touched){
          <mat-error>
            @if (password.errors?.['required']){
                <ng-container>Password is required</ng-container>
            }
            @if (password.errors?.['minlength']){
              <ng-container> At least 8 characters</ng-container>
            }
            @if (password.errors?.['pattern']){
              <ng-container>Use letters and numbers</ng-container>
            }
          </mat-error>
        }
      </mat-form-field>

      <!-- Confirm password -->
      <mat-form-field appearance="outline" class="full">
        <mat-label>Confirm password</mat-label>
        <input
          matInput
          [type]="showConfirm ? 'text' : 'password'"
          name="ConfirmPassword"
          [(ngModel)]="confirmPassword"
          #confirm="ngModel"
          required
          minlength="8"
          autocomplete="new-password" />
        <button mat-icon-button matSuffix type="button"
                (click)="showConfirm = !showConfirm"
                [attr.aria-label]="showConfirm ? 'Hide password' : 'Show password'">
          <mat-icon>{{ showConfirm ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        @if (confirm.touched && (confirm.errors?.['required'] || confirm.errors?.['matchTo'])){
          <mat-error>
            {{ confirm.errors?.['required'] ? 'Please confirm your password' : 'Passwords do not match' }}
          </mat-error>
        }
        @if(confirm.touched && confirm.value !== password.value){
          <mat-error>
          {{"Passwords do not match"}}
          </mat-error>
        }
      </mat-form-field>
  
      <!-- Terms -->
      <mat-checkbox
        class="full"
        name="terms"
        [(ngModel)]="terms"
        #termsCtrl="ngModel"
        required>
        I agree to the Terms &amp; Privacy Policy
      </mat-checkbox>
  
      <!-- Submit -->
      <div class="actions full">
        <button mat-flat-button color="primary" type="submit"  [disabled]="f.invalid || isLoading">
         
          @if (isLoading){
            <mat-spinner></mat-spinner>
          }
          @else{
            Create account
          }
        </button> 
      </div>
          <mat-divider class="mb-3"></mat-divider>
          <div class="actions full">
            <a mat-button routerLink="/auth/login">Already have an account? Log in</a>
          </div>   
    </form>
</div>