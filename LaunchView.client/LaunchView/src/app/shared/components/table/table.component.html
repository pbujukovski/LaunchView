<div class="grid-container">
  <mat-form-field appearance="outline">
    <mat-icon matPrefix>search</mat-icon>
    <input matInput (input)="applyFilter($event)" placeholder="Search" />
  </mat-form-field>

  <div class="table-content">
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      [matSortActive]="sortBy || ''"        
      [matSortDirection]="sortDir || ''"
      (matSortChange)="onSortChange($event)"
    >
      @for (col of columnDefs; track col.columnDef) {
        <ng-container [matColumnDef]="col.columnDef">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ col.header }}
          </th>

          <td mat-cell *matCellDef="let element">
            @switch (col.type) {
              @case ('date') {
                {{ element[col.columnDef] ? (element[col.columnDef] | date:'MM/dd/yyyy') : '' }}
              }
              @case ('status') {
                <mat-checkbox
                  [disabled]="true"
                  [checked]="!!element[col.columnDef]"
                  (change)="onAction('toggleStatus', element)">
                </mat-checkbox>
              }
              @case ('actions') {
                <button mat-icon-button (click)="onAction('edit', element)">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button (click)="onAction('delete', element)">
                  <mat-icon>delete</mat-icon>
                </button>
              }
              @default {
                {{ element[col.columnDef] }}
              }
            }
          </td>
        </ng-container>
      }

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <mat-paginator
      #paginator
      [length]="length || 0"
      [pageIndex]="pageIndex || 0"
      [pageSize]="pageSize || 10"
      [pageSizeOptions]="pageSizeOptions || [5, 10, 25 , 50]"
      showFirstLastButtons
      (page)="pageChanged.emit($event)">
    </mat-paginator>
  </div>
</div>
